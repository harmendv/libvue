import{o as S}from"./index.d3862298.js";import{p as g}from"./propSizeMixin.c60c30ad.js";import O from"./LvSelectOption.c61f4997.js";import{_ as C,c as a,a as _,r,f as h,J as y,t as d,F as V,k as v,i as K,j as p,w as b,d as L,l as k,s as B,n as N,o,b as c,K as E,v as T,g as w}from"./index.555261bd.js";import"./index.bf7614b3.js";const z={components:{LvSelectOption:O},mixins:[g()],props:{modelValue:{type:[String,Number,Array],default:null},multiple:{type:Boolean,default:!1},searchable:{type:Boolean,default:!1},placeholder:{type:String,default:e=>e.searchable?"Search an option":"Choose an option"},clearable:{type:Boolean,default:!0},loading:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},teleportTarget:{type:String,default:"body"},options:{type:Array,default:()=>[]},optionValueKey:{type:String,default:"value"},optionLabelKey:{type:String,default:"label"}},emits:["update:modelValue"],data(){return{dropdownVisible:!1,focusedOptionIndex:null,search:null}},computed:{searchedOptions(){return this.search?this.options.filter(e=>e[this.optionLabelKey].toLowerCase().includes(this.search.toLowerCase())):this.options},selectedOption(){return this.multiple?!1:this.options.find(l=>l[this.optionValueKey]===this.modelValue)||!1},selectedOptions(){return this.multiple?this.options.filter(e=>this.modelValue.includes(e[this.optionValueKey])):!1},focusTrapOptions(){return{immediate:!0,escapeDeactivates:!1,fallbackFocus:document.body}},hasValue(){return!!(this.multiple&&this.modelValue.length>0||!this.multiple&&this.modelValue)},classObject(){return{[`lv-select--size-${this.size}`]:!0,"lv-select--disabled":!!this.disabled||!!this.loading,"lv-select--loading":!!this.loading}}},watch:{search(e){!this.dropdownVisible&&e&&(this.dropdownVisible=!0)},value(e){!this.multiple&&this.dropdownVisible&&(this.dropdownVisible=!1),e&&this.search&&(this.search=null)}},mounted(){S(this.$refs.select,()=>{this.dropdownVisible=!1})},methods:{onClickSelection(){this.dropdownVisible=!this.dropdownVisible},onEscape(){this.dropdownVisible=!1},onClickOption(e){if(!this.multiple)this.modelValue===e[this.optionValueKey]&&this.clearable?this.$emit("update:modelValue",null):(this.$emit("update:modelValue",e[this.optionValueKey]),this.dropdownVisible=!1);else if(this.multiple){const l=[...this.modelValue];if(this.modelValue.includes(e[this.optionValueKey])){const i=this.modelValue.findIndex(m=>m===e[this.optionValueKey]);l.splice(i,1),this.$emit("update:modelValue",l)}else l.push(e[this.optionValueKey]),this.$emit("update:modelValue",l)}},isSelected(e){return!!(this.multiple&&this.modelValue.includes(e[this.optionValueKey])||!this.multiple&&this.modelValue===e[this.optionValueKey])}}},M=["aria-expanded"],j={key:0,class:"lv-select__value"},D=["placeholder"],F={key:2,class:"lv-select__placeholder"},A={key:1,class:"lv-select__value"},I=["placeholder"],U={key:2,class:"lv-select__placeholder"},J={class:"lv-select__dropdown",role:"listbox"},q={key:1,class:"lv-select__no-options"},G=c(" No options found ");function H(e,l,i,m,n,s){const f=w("lv-icon"),x=w("lv-select-option");return o(),a("div",{ref:"select",class:N(["lv-select",s.classObject]),role:"combobox","aria-expanded":n.dropdownVisible,"aria-haspopup":"listbox",onKeydown:l[4]||(l[4]=b((...t)=>s.onEscape&&s.onEscape(...t),["esc"]))},[_("div",{ref:"combobox",class:"lv-select__input",tabindex:"0",onClick:l[2]||(l[2]=(...t)=>s.onClickSelection&&s.onClickSelection(...t)),onKeydown:l[3]||(l[3]=b(E((...t)=>s.onClickSelection&&s.onClickSelection(...t),["prevent"]),["enter","space"]))},[i.multiple?i.multiple?(o(),a("div",A,[s.hasValue?(o(!0),a(V,{key:0},v(s.selectedOptions,(t,u)=>(o(),a("span",{key:u,class:"lv-select__value-item"},[r(e.$slots,"value",{option:t},()=>[c(d(t[i.optionLabelKey]),1)])]))),128)):i.searchable?h((o(),a("input",{key:1,"onUpdate:modelValue":l[1]||(l[1]=t=>n.search=t),class:"lv-select__search",type:"text",placeholder:i.placeholder},null,8,I)),[[y,n.search]]):(o(),a("div",U,d(i.placeholder),1))])):K("",!0):(o(),a("div",j,[s.hasValue?r(e.$slots,"value",{key:0,option:s.selectedOption},()=>[c(d(s.selectedOption[i.optionLabelKey]),1)]):i.searchable?h((o(),a("input",{key:1,"onUpdate:modelValue":l[0]||(l[0]=t=>n.search=t),class:"lv-select__search",type:"text",placeholder:i.placeholder},null,8,D)),[[y,n.search]]):(o(),a("div",F,d(i.placeholder),1))])),i.loading?(o(),p(f,{key:2,class:"lv-select__loading",name:"loader-2"})):(o(),p(f,{key:3,class:"lv-select__icon",name:"chevron-down"}))],544),L(B,{name:"dropdown"},{default:k(()=>[h(_("div",J,[s.searchedOptions.length>0?(o(!0),a(V,{key:0},v(s.searchedOptions,(t,u)=>(o(),p(x,{key:u,option:t,selected:s.isSelected(t),checkbox:!!i.multiple,onClick:s.onClickOption},{default:k(()=>[r(e.$slots,"option",{option:t},()=>[c(d(t.label),1)])]),_:2},1032,["option","selected","checkbox","onClick"]))),128)):(o(),a("div",q,[r(e.$slots,"no-options",{},()=>[G])]))],512),[[T,n.dropdownVisible]])]),_:3})],42,M)}const Y=C(z,[["render",H]]);export{Y as default};
